package org.study.llf.spring.elasticsearch;

import com.alibaba.fastjson.JSON;
import com.alibaba.fastjson.JSONObject;
import org.junit.Test;
import org.junit.runner.RunWith;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.boot.test.context.SpringBootTest;
import org.springframework.data.elasticsearch.core.ElasticsearchTemplate;
import org.springframework.test.context.TestPropertySource;
import org.springframework.test.context.junit4.SpringJUnit4ClassRunner;
import org.study.llf.spring.elasticsearch.dao.FsInfoMapper;
import org.study.llf.spring.elasticsearch.dao.ServiceInfoMapper;
import org.study.llf.spring.elasticsearch.pojo.CpuInfo;
import org.study.llf.spring.elasticsearch.pojo.FsInfo;

import java.util.List;

/**
 * Description 类描述
 *
 * @author luolifeng
 * @version 1.0.0
 * Date 2019-03-29
 * Time 17:33
 */
@RunWith(SpringJUnit4ClassRunner.class)
@SpringBootTest(classes = MyApp.class)
@TestPropertySource(locations = "classpath:application.yml")
public class My {
    @Autowired
    ServiceInfoMapper serviceInfoMapper;
    @Autowired
    FsInfoMapper fsInfoMapper;
    @Test
    public void test(){
        String js="{\"took\":1,\"timed_out\":false,\"_shards\":{\"total\":5,\"successful\":5,\"skipped\":0,\"failed\":0},\"hits\":{\"total\":52,\"max_score\":1.0,\"hits\":[{\"_index\":\"glances-2019.03.29\",\"_type\":\"glances\",\"_id\":\"c7b6ed86-51e8-11e9-ab34-5891cf69bca6\",\"_score\":1.0,\"_source\":{\"timestamp\":\"2019-03-29T06:06:23.642765\",\"plugins\":[\"cpu\",\"percpu\",\"load\",\"mem\",\"memswap\",\"network\",\"diskio\",\"fs\",\"processcount\",\"ip\",\"system\",\"uptime\",\"sensors\",\"docker\",\"gpu\",\"net_stat\"],\"dataType\":\"HW\",\"content\":{\"mem\":{\"history_size\":28800.0,\"free\":8819900416,\"percent\":47.7,\"mem_careful\":50.0,\"available\":8819900416,\"used\":8031563776,\"total\":16851464192,\"mem_critical\":90.0,\"mem_warning\":70.0},\"cpu\":{\"cpu_steal_critical\":90.0,\"cpu_user_warning\":70.0,\"cpu_iowait_critical\":25.0,\"cpu_disable\":\"False\",\"total\":24.0,\"cpu_steal_warning\":70.0,\"cpu_system_warning\":70.0,\"cpu_iowait_warning\":22.5,\"cpu_ctx_switches_critical\":200000.0,\"cpu_system_critical\":90.0,\"syscalls\":275347,\"cpu_system_careful\":50.0,\"cpu_ctx_switches_careful\":160000.0,\"cpu_user_critical\":90.0,\"user\":7.6,\"interrupts\":70346,\"cpucore\":4,\"system\":15.4,\"cpu_iowait_careful\":20.0,\"cpu_ctx_switches_warning\":180000.0,\"soft_interrupts\":0,\"history_size\":28800.0,\"cpu_user_careful\":50.0,\"ctx_switches\":117476,\"cpu_steal_careful\":50.0,\"time_since_update\":4.970791816711426,\"idle\":76.0},\"ip\":{\"history_size\":28800.0},\"system\":{\"platform\":\"64bit\",\"history_size\":28800.0,\"hostname\":\"DESKTOP-QR10DSE\",\"hr_name\":\"Windows 10 SP0 64bit\",\"os_version\":\"10 SP0\",\"os_name\":\"Windows\"},\"percpu\":{\"3.percpu_system_careful\":50.0,\"1.percpu_system_careful\":50.0,\"3.percpu_system_warning\":70.0,\"1.total\":20.5,\"2.user\":6.9,\"3.percpu_user_careful\":50.0,\"1.percpu_system_warning\":70.0,\"3.percpu_user_warning\":70.0,\"2.percpu_system_careful\":50.0,\"2.percpu_system_warning\":70.0,\"0.system\":19.0,\"3.system\":16.3,\"1.percpu_system_critical\":90.0,\"3.percpu_system_critical\":90.0,\"1.percpu_user_critical\":90.0,\"1.user\":6.8,\"0.percpu_system_critical\":90.0,\"0.key\":\"cpu_number\",\"0.percpu_system_warning\":70.0,\"0.cpu_number\":0,\"0.total\":27.5,\"1.percpu_user_careful\":50.0,\"2.percpu_iowait_warning\":70.0,\"3.cpu_number\":3,\"2.percpu_user_careful\":50.0,\"1.idle\":79.5,\"0.percpu_iowait_warning\":70.0,\"3.percpu_user_critical\":90.0,\"1.percpu_iowait_warning\":70.0,\"2.percpu_system_critical\":90.0,\"2.system\":13.1,\"3.percpu_iowait_warning\":70.0,\"1.percpu_iowait_careful\":50.0,\"0.percpu_user_warning\":70.0,\"2.total\":20.6,\"3.key\":\"cpu_number\",\"1.percpu_user_warning\":70.0,\"3.total\":27.3,\"0.idle\":72.5,\"0.user\":6.1,\"1.percpu_iowait_critical\":90.0,\"0.percpu_user_critical\":90.0,\"2.percpu_user_warning\":70.0,\"2.cpu_number\":2,\"2.idle\":79.4,\"2.history_size\":28800.0,\"3.user\":11.0,\"2.percpu_iowait_critical\":90.0,\"0.percpu_iowait_critical\":90.0,\"1.key\":\"cpu_number\",\"0.history_size\":28800.0,\"0.percpu_system_careful\":50.0,\"1.system\":13.0,\"3.percpu_iowait_careful\":50.0,\"1.cpu_number\":1,\"2.percpu_user_critical\":90.0,\"0.percpu_user_careful\":50.0,\"3.percpu_iowait_critical\":90.0,\"3.idle\":72.7,\"0.percpu_iowait_careful\":50.0,\"2.percpu_iowait_careful\":50.0,\"2.key\":\"cpu_number\",\"3.history_size\":28800.0,\"1.history_size\":28800.0},\"gpu\":{},\"diskio\":{\"PhysicalDrive1.read_bytes\":0,\"PhysicalDrive1.read_count\":0,\"PhysicalDrive1.write_bytes\":549888,\"PhysicalDrive0.disk_name\":\"PhysicalDrive0\",\"PhysicalDrive1.history_size\":28800.0,\"PhysicalDrive0.read_bytes\":0,\"PhysicalDrive1.write_count\":29,\"PhysicalDrive0.time_since_update\":4.980011701583862,\"PhysicalDrive0.write_count\":0,\"PhysicalDrive1.time_since_update\":4.980011701583862,\"PhysicalDrive1.key\":\"disk_name\",\"PhysicalDrive0.key\":\"disk_name\",\"PhysicalDrive1.diskio_hide\":\"loop.*\",\"PhysicalDrive0.read_count\":0,\"PhysicalDrive0.write_bytes\":0,\"PhysicalDrive1.disk_name\":\"PhysicalDrive1\",\"PhysicalDrive0.history_size\":28800.0,\"PhysicalDrive0.diskio_hide\":\"loop.*\"},\"sensors\":{\"Battery.label\":\"Battery\",\"Battery.sensors_temperature_hdd_warning\":52.0,\"Battery.sensors_temperature_core_warning\":70.0,\"Battery.value\":100,\"Battery.unit\":\"%\",\"Battery.sensors_battery_careful\":80.0,\"Battery.sensors_temperature_core_critical\":80.0,\"Battery.sensors_temperature_core_careful\":60.0,\"Battery.sensors_battery_warning\":90.0,\"Battery.sensors_temperature_hdd_careful\":45.0,\"Battery.sensors_battery_critical\":95.0,\"Battery.history_size\":28800.0,\"Battery.key\":\"label\",\"Battery.type\":\"battery\",\"Battery.sensors_temperature_hdd_critical\":60.0},\"network\":{\"以太网.is_up\":\"true\",\"VMware Network Adapter VMnet1.cumulative_rx\":43,\"以太网.key\":\"interface_name\",\"本地连接* 4.cumulative_tx\":0,\"VMware Network Adapter VMnet1.interface_name\":\"VMware Network Adapter VMnet1\",\"以太网 2.cumulative_cx\":568821895,\"VMware Network Adapter VMnet1.cumulative_tx\":1665,\"VMware Network Adapter VMnet1.tx\":0,\"Loopback Pseudo-Interface 1.network_rx_careful\":70.0,\"本地连接* 1.cx\":0,\"本地连接* 4.history_size\":28800.0,\"本地连接* 4.network_tx_warning\":80.0,\"Loopback Pseudo-Interface 1.network_rx_critical\":90.0,\"以太网 2.rx\":873,\"本地连接* 4.cumulative_cx\":0,\"Loopback Pseudo-Interface 1.tx\":0,\"以太网 2.speed\":10485760,\"VMware Network Adapter VMnet1.network_rx_critical\":90.0,\"WLAN.tx\":0,\"VMware Network Adapter VMnet1.network_rx_careful\":70.0,\"VMware Network Adapter VMnet8.cumulative_cx\":6673,\"VMware Network Adapter VMnet8.cx\":0,\"本地连接* 4.time_since_update\":4.972777605056763,\"蓝牙网络连接.cumulative_cx\":0,\"本地连接* 1.history_size\":28800.0,\"本地连接* 1.network_rx_warning\":80.0,\"以太网 2.network_tx_critical\":90.0,\"以太网.tx\":35436,\"VMware Network Adapter VMnet1.cx\":0,\"WLAN.cumulative_rx\":19978884,\"以太网 2.time_since_update\":4.972777605056763,\"Loopback Pseudo-Interface 1.rx\":0,\"以太网 2.network_rx_careful\":70.0,\"本地连接* 1.rx\":0,\"VMware Network Adapter VMnet1.network_tx_warning\":80.0,\"以太网 2.key\":\"interface_name\",\"蓝牙网络连接.cumulative_rx\":0,\"Loopback Pseudo-Interface 1.key\":\"interface_name\",\"本地连接* 4.cumulative_rx\":0,\"VMware Network Adapter VMnet8.key\":\"interface_name\",\"本地连接* 4.key\":\"interface_name\",\"WLAN.key\":\"interface_name\",\"VMware Network Adapter VMnet1.time_since_update\":4.972777605056763,\"Loopback Pseudo-Interface 1.cumulative_rx\":0,\"Loopback Pseudo-Interface 1.cumulative_tx\":0,\"Loopback Pseudo-Interface 1.interface_name\":\"Loopback Pseudo-Interface 1\",\"WLAN.network_rx_careful\":70.0,\"以太网.cx\":630284,\"本地连接* 4.network_rx_critical\":90.0,\"VMware Network Adapter VMnet1.key\":\"interface_name\",\"WLAN.speed\":254803968,\"以太网 2.tx\":14187,\"蓝牙网络连接.rx\":0,\"VMware Network Adapter VMnet8.network_tx_warning\":80.0,\"本地连接* 1.cumulative_rx\":0,\"WLAN.network_rx_critical\":90.0,\"以太网.network_tx_critical\":90.0,\"WLAN.history_size\":28800.0,\"蓝牙网络连接.history_size\":28800.0,\"本地连接* 4.interface_name\":\"本地连接* 4\",\"本地连接* 1.network_rx_critical\":90.0,\"蓝牙网络连接.is_up\":\"false\",\"WLAN.network_tx_careful\":70.0,\"以太网.cumulative_rx\":411181754,\"以太网.time_since_update\":4.972777605056763,\"VMware Network Adapter VMnet8.network_tx_critical\":90.0,\"本地连接* 1.interface_name\":\"本地连接* 1\",\"VMware Network Adapter VMnet1.network_tx_critical\":90.0,\"以太网 2.is_up\":\"true\",\"以太网 2.network_rx_critical\":90.0,\"本地连接* 1.is_up\":\"false\",\"以太网 2.cx\":15060,\"本地连接* 1.network_tx_warning\":80.0,\"WLAN.network_tx_critical\":90.0,\"WLAN.rx\":0,\"蓝牙网络连接.network_rx_warning\":80.0,\"WLAN.cumulative_tx\":4848364,\"以太网.cumulative_tx\":25683179,\"以太网 2.network_rx_warning\":80.0,\"Loopback Pseudo-Interface 1.network_tx_warning\":80.0,\"Loopback Pseudo-Interface 1.speed\":1125122048,\"VMware Network Adapter VMnet1.cumulative_cx\":1708,\"本地连接* 4.network_tx_careful\":70.0,\"VMware Network Adapter VMnet8.network_rx_warning\":80.0,\"本地连接* 4.network_rx_careful\":70.0,\"VMware Network Adapter VMnet1.history_size\":28800.0,\"Loopback Pseudo-Interface 1.network_tx_critical\":90.0,\"VMware Network Adapter VMnet1.network_tx_careful\":70.0,\"蓝牙网络连接.key\":\"interface_name\",\"蓝牙网络连接.network_rx_critical\":90.0,\"以太网 2.network_tx_warning\":80.0,\"以太网.interface_name\":\"以太网\",\"Loopback Pseudo-Interface 1.is_up\":\"true\",\"以太网.network_tx_warning\":80.0,\"本地连接* 1.speed\":0,\"蓝牙网络连接.network_rx_careful\":70.0,\"以太网 2.history_size\":28800.0,\"本地连接* 1.key\":\"interface_name\",\"本地连接* 4.network_tx_critical\":90.0,\"本地连接* 1.time_since_update\":4.972777605056763,\"VMware Network Adapter VMnet8.speed\":104857600,\"蓝牙网络连接.network_tx_critical\":90.0,\"以太网 2.cumulative_rx\":498412030,\"本地连接* 1.network_tx_careful\":70.0,\"蓝牙网络连接.time_since_update\":4.972777605056763,\"VMware Network Adapter VMnet8.network_rx_critical\":90.0,\"WLAN.cumulative_cx\":24827248,\"以太网.cumulative_cx\":436864933,\"VMware Network Adapter VMnet8.is_up\":\"true\",\"本地连接* 4.rx\":0,\"VMware Network Adapter VMnet8.interface_name\":\"VMware Network Adapter VMnet8\",\"VMware Network Adapter VMnet8.network_tx_careful\":70.0,\"WLAN.network_rx_warning\":80.0,\"VMware Network Adapter VMnet8.history_size\":28800.0,\"Loopback Pseudo-Interface 1.network_tx_careful\":70.0,\"以太网.network_rx_careful\":70.0,\"本地连接* 1.cumulative_tx\":0,\"VMware Network Adapter VMnet8.tx\":0,\"以太网.speed\":104857600,\"Loopback Pseudo-Interface 1.network_rx_warning\":80.0,\"蓝牙网络连接.network_tx_warning\":80.0,\"本地连接* 4.is_up\":\"false\",\"WLAN.is_up\":\"false\",\"以太网.network_rx_warning\":80.0,\"VMware Network Adapter VMnet1.is_up\":\"true\",\"以太网 2.network_tx_careful\":70.0,\"本地连接* 4.network_rx_warning\":80.0,\"VMware Network Adapter VMnet8.network_rx_careful\":70.0,\"以太网 2.interface_name\":\"以太网 2\",\"VMware Network Adapter VMnet8.rx\":0,\"WLAN.time_since_update\":4.972777605056763,\"VMware Network Adapter VMnet8.time_since_update\":4.972777605056763,\"Loopback Pseudo-Interface 1.cx\":0,\"蓝牙网络连接.tx\":0,\"VMware Network Adapter VMnet1.rx\":0,\"Loopback Pseudo-Interface 1.time_since_update\":4.972777605056763,\"WLAN.interface_name\":\"WLAN\",\"蓝牙网络连接.cx\":0,\"Loopback Pseudo-Interface 1.cumulative_cx\":0,\"VMware Network Adapter VMnet8.cumulative_tx\":6630,\"本地连接* 4.tx\":0,\"以太网.network_rx_critical\":90.0,\"以太网.rx\":594848,\"以太网.network_tx_careful\":70.0,\"本地连接* 1.cumulative_cx\":0,\"本地连接* 4.cx\":0,\"VMware Network Adapter VMnet1.network_rx_warning\":80.0,\"蓝牙网络连接.speed\":3145728,\"以太网.history_size\":28800.0,\"WLAN.cx\":0,\"VMware Network Adapter VMnet8.cumulative_rx\":43,\"蓝牙网络连接.cumulative_tx\":0,\"以太网 2.cumulative_tx\":70409865,\"蓝牙网络连接.network_tx_careful\":70.0,\"本地连接* 1.network_tx_critical\":90.0,\"Loopback Pseudo-Interface 1.history_size\":28800.0,\"蓝牙网络连接.interface_name\":\"蓝牙网络连接\",\"本地连接* 1.network_rx_careful\":70.0,\"本地连接* 1.tx\":0,\"WLAN.network_tx_warning\":80.0,\"本地连接* 4.speed\":0,\"VMware Network Adapter VMnet1.speed\":104857600},\"net_stat\":{\"last_ack\":1,\"time_wait\":7,\"listen\":72,\"established\":164,\"history_size\":28800.0,\"syn_sent\":8,\"close_wait\":11},\"fs\":{\"F:\\\\.free\":58561888256,\"E:\\\\.free\":108644085760,\"E:\\\\.fs_hide\":\"/boot.*\",\"D:\\\\.fs_type\":\"NTFS\",\"E:\\\\.used\":69598101504,\"G:\\\\.key\":\"mnt_point\",\"E:\\\\.history_size\":28800.0,\"F:\\\\.key\":\"mnt_point\",\"G:\\\\.fs_warning\":70.0,\"G:\\\\.fs_hide\":\"/boot.*\",\"C:\\\\.fs_critical\":90.0,\"D:\\\\.percent\":82.0,\"E:\\\\.fs_warning\":70.0,\"D:\\\\.free\":7592636416,\"C:\\\\.fs_hide\":\"/boot.*\",\"F:\\\\.fs_careful\":50.0,\"F:\\\\.device_name\":\"F:\\\\\",\"E:\\\\.size\":178242187264,\"F:\\\\.fs_hide\":\"/boot.*\",\"C:\\\\.size\":84993417216,\"D:\\\\.fs_hide\":\"/boot.*\",\"G:\\\\.fs_careful\":50.0,\"E:\\\\.percent\":39.0,\"F:\\\\.fs_type\":\"NTFS\",\"D:\\\\.used\":34540191744,\"D:\\\\.fs_warning\":70.0,\"G:\\\\.free\":61282480128,\"D:\\\\.history_size\":28800.0,\"C:\\\\.fs_type\":\"NTFS\",\"C:\\\\.device_name\":\"C:\\\\\",\"F:\\\\.percent\":72.7,\"G:\\\\.device_name\":\"G:\\\\\",\"F:\\\\.fs_warning\":70.0,\"G:\\\\.fs_type\":\"NTFS\",\"E:\\\\.fs_critical\":90.0,\"G:\\\\.percent\":42.8,\"D:\\\\.fs_critical\":90.0,\"C:\\\\.used\":74349359104,\"F:\\\\.fs_critical\":90.0,\"D:\\\\.size\":42132828160,\"C:\\\\.percent\":87.5,\"G:\\\\.used\":45829554176,\"C:\\\\.key\":\"mnt_point\",\"F:\\\\.size\":214749409280,\"C:\\\\.mnt_point\":\"C:\\\\\",\"E:\\\\.fs_careful\":50.0,\"C:\\\\.fs_warning\":70.0,\"F:\\\\.mnt_point\":\"F:\\\\\",\"C:\\\\.free\":10644058112,\"E:\\\\.mnt_point\":\"E:\\\\\",\"E:\\\\.device_name\":\"E:\\\\\",\"D:\\\\.mnt_point\":\"D:\\\\\",\"D:\\\\.device_name\":\"D:\\\\\",\"G:\\\\.size\":107112034304,\"G:\\\\.fs_critical\":90.0,\"G:\\\\.history_size\":28800.0,\"C:\\\\.history_size\":28800.0,\"E:\\\\.fs_type\":\"NTFS\",\"E:\\\\.key\":\"mnt_point\",\"D:\\\\.key\":\"mnt_point\",\"D:\\\\.fs_careful\":50.0,\"G:\\\\.mnt_point\":\"G:\\\\\",\"F:\\\\.used\":156187521024,\"F:\\\\.history_size\":28800.0,\"C:\\\\.fs_careful\":50.0},\"memswap\":{\"free\":5946945536,\"percent\":69.3,\"history_size\":28800.0,\"memswap_warning\":70.0,\"sout\":0,\"sin\":0,\"used\":13454655488,\"total\":19401601024,\"memswap_careful\":50.0,\"memswap_critical\":90.0},\"uptime\":{\"seconds\":1034646,\"history_size\":28800.0},\"docker\":{},\"processcount\":{\"thread\":3010,\"running\":220,\"pid_max\":0,\"history_size\":28800.0,\"total\":226,\"sleeping\":0},\"load\":{\"load_careful\":0.7,\"history_size\":28800.0,\"load_warning\":1.0,\"load_critical\":5.0}},\"clientIdentifying\":\"localhost\",\"dataIdentifying\":\"SERVER\"}}]}}";

        JSONObject j2=JSONObject.parseObject(js);
//        System.out.println(j2);
        ElasticsearchTemplate k;
        List<CpuInfo> cpuInfoList=serviceInfoMapper.findByIdleBetween( 81,82);
        System.out.println(cpuInfoList);
        Iterable<FsInfo> rst=fsInfoMapper.findAll();
        System.out.println(rst);
        for (FsInfo a : rst) {
            System.out.println(a);
        }
    }
}
